{"ast":null,"code":"//\n// Topic correlations\n//\n\n/* This function will compute pairwise correlations between topics.\n * Unlike the correlated topic model (CTM) LDA doesn't have parameters\n * that represent topic correlations. But that doesn't mean that topics are\n * not correlated, it just means we have to estimate those values by\n * measuring which topics appear in documents together.\n */\n// used by ready, changeNumTopics in processing, used by sweep in sweep\nfunction plotMatrix() {\n  var left = 50;\n  var right = 500;\n  var top = 50;\n  var bottom = 500;\n  var correlationMatrix = getTopicCorrelations();\n  var correlationGraph = getCorrelationGraph(correlationMatrix, -100.0);\n  var topicScale = d3.scalePoint().domain(d3.range(numTopics)).range([left, right]);\n  var radiusScale = d3.scaleSqrt().domain([0, 1.0]).range([0, 450 / (2 * numTopics)]);\n  var horizontalTopics = vis.selectAll(\"text.hor\").data(correlationGraph.nodes);\n  horizontalTopics.exit().remove();\n  horizontalTopics = horizontalTopics.enter().append(\"text\").attr(\"class\", \"hor\").merge(horizontalTopics);\n  horizontalTopics.attr(\"x\", right + 10).attr(\"y\", function (node) {\n    return topicScale(node.name);\n  }).text(function (node) {\n    return node.words;\n  });\n  var verticalTopics = vis.selectAll(\"text.ver\").data(correlationGraph.nodes);\n  verticalTopics.exit().remove();\n  verticalTopics = verticalTopics.enter().append(\"text\").attr(\"class\", \"ver\").merge(verticalTopics);\n  verticalTopics.attr(\"x\", function (node) {\n    return topicScale(node.name);\n  }).attr(\"y\", bottom + 10).attr(\"transform\", function (node) {\n    return \"rotate(90,\" + topicScale(node.name) + \",\" + (bottom + 10) + \")\";\n  }).text(function (node) {\n    return node.words;\n  });\n  var circles = vis.selectAll(\"circle\").data(correlationGraph.links);\n  circles.exit().remove();\n  circles = circles.enter().append(\"circle\").merge(circles);\n  circles.attr(\"cx\", function (link) {\n    return topicScale(link.source);\n  }).attr(\"cy\", function (link) {\n    return topicScale(link.target);\n  }).attr(\"r\", function (link) {\n    return radiusScale(Math.abs(link.value));\n  }).style(\"fill\", function (link) {\n    return link.value > 0.0 ? \"#88f\" : \"#f88\";\n  }).on(\"mouseover\", function (link) {\n    var tooltip = d3.select(\"#tooltip\");\n    tooltip.style(\"visibility\", \"visible\").style(\"top\", event.pageY - 10 + \"px\").style(\"left\", event.pageX + 20 + \"px\").text(correlationGraph.nodes[link.target].words + \" / \" + correlationGraph.nodes[link.source].words);\n  }).on(\"mouseout\", function () {\n    var tooltip = d3.select(\"#tooltip\");\n    tooltip.style(\"visibility\", \"hidden\");\n  });\n} // Used by saveTopicPMI\n\n\nfunction getTopicCorrelations() {\n  // initialize the matrix\n  correlationMatrix = new Array(numTopics);\n\n  for (var t1 = 0; t1 < numTopics; t1++) {\n    correlationMatrix[t1] = zeros(numTopics);\n  }\n\n  var topicProbabilities = zeros(numTopics); // iterate once to get mean log topic proportions\n\n  documents.forEach(function (d, i) {\n    // We want to find the subset of topics that occur with non-trivial concentration in this document.\n    // Only consider topics with at least the minimum number of tokens that are at least 5% of the doc.\n    var documentTopics = new Array();\n    var tokenCutoff = Math.max(correlationMinTokens, correlationMinProportion * d.tokens.length);\n\n    for (var topic = 0; topic < numTopics; topic++) {\n      if (d.topicCounts[topic] >= tokenCutoff) {\n        documentTopics.push(topic);\n        topicProbabilities[topic]++; // Count the number of docs with this topic\n      }\n    } // Look at all pairs of topics that occur in the document.\n\n\n    for (var i = 0; i < documentTopics.length - 1; i++) {\n      for (var j = i + 1; j < documentTopics.length; j++) {\n        correlationMatrix[documentTopics[i]][documentTopics[j]]++;\n        correlationMatrix[documentTopics[j]][documentTopics[i]]++;\n      }\n    }\n  });\n\n  for (var t1 = 0; t1 < numTopics - 1; t1++) {\n    for (var t2 = t1 + 1; t2 < numTopics; t2++) {\n      correlationMatrix[t1][t2] = Math.log(documents.length * correlationMatrix[t1][t2] / (topicProbabilities[t1] * topicProbabilities[t2]));\n      correlationMatrix[t2][t1] = Math.log(documents.length * correlationMatrix[t2][t1] / (topicProbabilities[t1] * topicProbabilities[t2]));\n    }\n  }\n\n  return correlationMatrix;\n}\n\nfunction getCorrelationGraph(correlationMatrix, cutoff) {\n  var graph = {\n    \"nodes\": [],\n    \"links\": []\n  };\n\n  for (var topic = 0; topic < numTopics; topic++) {\n    graph.nodes.push({\n      \"name\": topic,\n      \"group\": 1,\n      \"words\": topNWords(topicWordCounts[topic], 3)\n    });\n  }\n\n  for (var t1 = 0; t1 < numTopics; t1++) {\n    for (var t2 = 0; t2 < numTopics; t2++) {\n      if (t1 !== t2 && correlationMatrix[t1][t2] > cutoff) {\n        graph.links.push({\n          \"source\": t1,\n          \"target\": t2,\n          \"value\": correlationMatrix[t1][t2]\n        });\n      }\n    }\n  }\n\n  return graph;\n}","map":{"version":3,"sources":["/Users/tatsukikuze12/Desktop/PastClasses/SummerResearch/jsLDAcopy/myapp/src/funcs/correlation.js"],"names":["plotMatrix","left","right","top","bottom","correlationMatrix","getTopicCorrelations","correlationGraph","getCorrelationGraph","topicScale","d3","scalePoint","domain","range","numTopics","radiusScale","scaleSqrt","horizontalTopics","vis","selectAll","data","nodes","exit","remove","enter","append","attr","merge","node","name","text","words","verticalTopics","circles","links","link","source","target","Math","abs","value","style","on","tooltip","select","event","pageY","pageX","Array","t1","zeros","topicProbabilities","documents","forEach","d","i","documentTopics","tokenCutoff","max","correlationMinTokens","correlationMinProportion","tokens","length","topic","topicCounts","push","j","t2","log","cutoff","graph","topNWords","topicWordCounts"],"mappings":"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","sourcesContent":["\n  //\n  // Topic correlations\n  //\n  \n  /* This function will compute pairwise correlations between topics.\n   * Unlike the correlated topic model (CTM) LDA doesn't have parameters\n   * that represent topic correlations. But that doesn't mean that topics are\n   * not correlated, it just means we have to estimate those values by\n   * measuring which topics appear in documents together.\n   */\n  \n// used by ready, changeNumTopics in processing, used by sweep in sweep\nfunction plotMatrix() {\n    \n    var left = 50;\n    var right = 500;\n    var top = 50;\n    var bottom = 500;\n  \n    var correlationMatrix = getTopicCorrelations();\n    var correlationGraph = getCorrelationGraph(correlationMatrix, -100.0);\n  \n    var topicScale = d3.scalePoint().domain(d3.range(numTopics)).range([left, right]);\n    var radiusScale = d3.scaleSqrt().domain([0, 1.0]).range([0, 450 / (2 * numTopics)]);\n  \n    var horizontalTopics = vis.selectAll(\"text.hor\").data(correlationGraph.nodes);\n    horizontalTopics.exit().remove();\n    horizontalTopics = horizontalTopics.enter().append(\"text\")\n      .attr(\"class\", \"hor\")\n    .merge(horizontalTopics);\n  \n    horizontalTopics\n      .attr(\"x\", right + 10)\n      .attr(\"y\", function(node) { return topicScale(node.name); })\n      .text(function(node) { return node.words; });\n  \n    var verticalTopics = vis.selectAll(\"text.ver\").data(correlationGraph.nodes);\n    verticalTopics.exit().remove();\n    verticalTopics = verticalTopics.enter().append(\"text\")\n      .attr(\"class\", \"ver\")\n    .merge(verticalTopics);\n  \n    verticalTopics\n      .attr(\"x\", function(node) { return topicScale(node.name); })\n      .attr(\"y\", bottom + 10)\n      .attr(\"transform\", function(node) { return \"rotate(90,\" + topicScale(node.name) + \",\" + (bottom + 10) + \")\"; })\n      .text(function(node) { return node.words; });\n  \n    var circles = vis.selectAll(\"circle\").data(correlationGraph.links);\n    circles.exit().remove();\n    circles = circles.enter().append(\"circle\").merge(circles);\n  \n    circles.attr(\"cx\", function(link) { return topicScale(link.source); })\n    .attr(\"cy\", function(link) { return topicScale(link.target); })\n    .attr(\"r\", function (link) { return radiusScale(Math.abs(link.value)); })\n    .style(\"fill\", function (link) { return link.value > 0.0 ? \"#88f\" : \"#f88\"; })\n    .on(\"mouseover\", function (link) {\n      var tooltip = d3.select(\"#tooltip\");\n      tooltip.style(\"visibility\", \"visible\")\n      .style(\"top\", (event.pageY-10)+\"px\").style(\"left\",(event.pageX+20)+\"px\")\n      .text(correlationGraph.nodes[link.target].words + \" / \" + correlationGraph.nodes[link.source].words);\n    })\n    .on(\"mouseout\", function () {\n      var tooltip = d3.select(\"#tooltip\");\n      tooltip.style(\"visibility\", \"hidden\");\n    });\n  }\n\n// Used by saveTopicPMI\nfunction getTopicCorrelations() {\n  \n    // initialize the matrix\n    correlationMatrix = new Array(numTopics);\n    for (var t1 = 0; t1 < numTopics; t1++) {\n      correlationMatrix[t1] = zeros(numTopics);\n    }\n  \n    var topicProbabilities = zeros(numTopics);\n  \n    // iterate once to get mean log topic proportions\n    documents.forEach(function(d, i) {\n  \n      // We want to find the subset of topics that occur with non-trivial concentration in this document.\n      // Only consider topics with at least the minimum number of tokens that are at least 5% of the doc.\n      var documentTopics = new Array();\n      var tokenCutoff = Math.max(correlationMinTokens, correlationMinProportion * d.tokens.length);\n  \n      for (var topic = 0; topic < numTopics; topic++) {\n        if (d.topicCounts[topic] >= tokenCutoff) {\n          documentTopics.push(topic);\n          topicProbabilities[topic]++; // Count the number of docs with this topic\n        }\n      }\n  \n      // Look at all pairs of topics that occur in the document.\n      for (var i = 0; i < documentTopics.length - 1; i++) {\n        for (var j = i + 1; j < documentTopics.length; j++) {\n          correlationMatrix[ documentTopics[i] ][ documentTopics[j] ]++;\n          correlationMatrix[ documentTopics[j] ][ documentTopics[i] ]++;\n        }\n      }\n    });\n    for (var t1 = 0; t1 < numTopics - 1; t1++) {\n      for (var t2 = t1 + 1; t2 < numTopics; t2++) {\n        correlationMatrix[t1][t2] = Math.log((documents.length * correlationMatrix[t1][t2]) /\n                                             (topicProbabilities[t1] * topicProbabilities[t2]));\n        correlationMatrix[t2][t1] = Math.log((documents.length * correlationMatrix[t2][t1]) /\n                                             (topicProbabilities[t1] * topicProbabilities[t2]));\n      }\n    }\n  \n    return correlationMatrix;\n  }\n\nfunction getCorrelationGraph(correlationMatrix, cutoff) {\n    var graph = {\"nodes\": [], \"links\": []};\n    for (var topic = 0; topic < numTopics; topic++) {\n      graph.nodes.push({\"name\": topic, \"group\": 1, \"words\": topNWords(topicWordCounts[topic], 3)});\n    }\n    for (var t1 = 0; t1 < numTopics; t1++) {\n      for (var t2 = 0; t2 < numTopics; t2++) {\n        if (t1 !== t2 && correlationMatrix[t1][t2] > cutoff) {\n          graph.links.push({\"source\": t1, \"target\": t2, \"value\": correlationMatrix[t1][t2]});\n        }\n      }\n    }\n    return graph;\n  }"]},"metadata":{},"sourceType":"module"}